services:
  - type: web
    name: cosmic-cults
    env: static
    buildCommand: |
      curl https://sh.rustup.rs -sSf | sh -s -- -y
      source $HOME/.cargo/env
      rustup target add wasm32-unknown-unknown
      cargo install wasm-bindgen-cli
      cargo build --release --target wasm32-unknown-unknown -p game-runner
      mkdir -p dist
      wasm-bindgen --out-dir dist --target web target/wasm32-unknown-unknown/release/game_runner.wasm
      cp index.html dist/
    staticPublishPath: dist
